!function(){return function e(t,r,i){function n(a,s){if(!r[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=r[a]={exports:{}};t[a][0].call(h.exports,function(e){return n(t[a][1][e]||e)},h,h.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}}()({1:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","./modules/observer"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("./modules/observer");window.webalyzeDebug=1,setTimeout(function(){window.webalyzeObserver=new r.Observer,window.webalyzeObserver.start()},500)})},{"./modules/observer":6}],2:[function(e,t,r){var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../util/types","../util/constants"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MutationSummary=t.Summary=t.NodeMap=void 0;var r=e("../util/types"),i=e("../util/constants"),o=globalThis.window.MutationObserver,a=function(){function e(){this.nodes=[],this.values=[]}return e.prototype.isIndex=function(e){return+e==e>>>0},e.prototype.nodeId=function(t){var r=t[e.ID_PROP];return r||(r=t[e.ID_PROP]=e.nextId_++),r},e.prototype.set=function(e,t){var r=this.nodeId(e);this.nodes[r]=e,this.values[r]=t},e.prototype.get=function(e){var t=this.nodeId(e);return this.values[t]},e.prototype.has=function(e){return this.nodeId(e)in this.nodes},e.prototype.delete=function(e){var t=this.nodeId(e);delete this.nodes[t],this.values[t]=void 0},e.prototype.keys=function(){var e=[];for(var t in this.nodes)this.isIndex(t)&&e.push(this.nodes[t]);return e},e.ID_PROP=i.MUTATION_SUMMARY_ID_PROP,e.nextId_=1,e}();t.NodeMap=a;var s=function(){function e(e,t,r,i,n,o,a,s){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n=null),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===s&&(s=null),this.node=e,this.childList=t,this.attributes=r,this.characterData=i,this.oldParentNode=n,this.added=o,this.attributeOldValues=a,this.characterDataOldValue=s,this.isCaseInsensitive=this.node.nodeType===Node.ELEMENT_NODE&&this.node instanceof HTMLElement&&this.node.ownerDocument instanceof HTMLDocument}return e.prototype.getAttributeOldValue=function(e){if(this.attributeOldValues)return this.isCaseInsensitive&&(e=e.toLowerCase()),this.attributeOldValues[e]},e.prototype.getAttributeNamesMutated=function(){var e=[];if(!this.attributeOldValues)return e;for(var t in this.attributeOldValues)e.push(t);return e},e.prototype.attributeMutated=function(e,t){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},e in this.attributeOldValues||(this.attributeOldValues[e]=t)},e.prototype.characterDataMutated=function(e){this.characterData||(this.characterData=!0,this.characterDataOldValue=e)},e.prototype.removedFromParent=function(e){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=e},e.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},e.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode},e}(),u=function(){return function(){this.added=new a,this.removed=new a,this.maybeMoved=new a,this.oldPrevious=new a,this.moved=void 0}}(),c=function(e){function t(t,r){var i=e.call(this)||this;i.rootNode=t,i.reachableCache=void 0,i.wasReachableCache=void 0,i.anyParentsChanged=!1,i.anyAttributesChanged=!1,i.anyCharacterDataChanged=!1;for(var n=0;n<r.length;n++){var o=r[n];switch(o.type){case"childList":i.anyParentsChanged=!0;for(var a=0;a<o.removedNodes.length;a++){var s=o.removedNodes[a];i.getChange(s).removedFromParent(o.target)}for(a=0;a<o.addedNodes.length;a++){s=o.addedNodes[a];i.getChange(s).insertedIntoParent()}break;case"attributes":i.anyAttributesChanged=!0,i.getChange(o.target).attributeMutated(o.attributeName,o.oldValue);break;case"characterData":i.anyCharacterDataChanged=!0,i.getChange(o.target).characterDataMutated(o.oldValue)}}return i}return n(t,e),t.prototype.getChange=function(e){var t=this.get(e);return t||(t=new s(e),this.set(e,t)),t},t.prototype.getOldParent=function(e){var t=this.get(e);return t?t.getOldParent():e.parentNode},t.prototype.getIsReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.reachableCache=this.reachableCache||new a;var t=this.reachableCache.get(e);return void 0===t&&(t=this.getIsReachable(e.parentNode),this.reachableCache.set(e,t)),t},t.prototype.getWasReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.wasReachableCache=this.wasReachableCache||new a;var t=this.wasReachableCache.get(e);return void 0===t&&(t=this.getWasReachable(this.getOldParent(e)),this.wasReachableCache.set(e,t)),t},t.prototype.reachabilityChange=function(e){return this.getIsReachable(e)?this.getWasReachable(e)?r.MOVEMENT.STAYED_IN:r.MOVEMENT.ENTERED:this.getWasReachable(e)?r.MOVEMENT.EXITED:r.MOVEMENT.STAYED_OUT},t}(a),h=function(){function e(e,t,r,i,n){this.rootNode=e,this.mutations=t,this.selectors=r,this.calcReordered=i,this.calcOldPreviousSibling=n,this.treeChanges=new c(e,t),this.entered=[],this.exited=[],this.stayedIn=new a,this.visited=new a,this.childListChangeMap=void 0,this.characterDataOnly=void 0,this.matchCache=void 0,this.processMutations()}return e.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var e=this.treeChanges.keys(),t=0;t<e.length;t++)this.visitNode(e[t],void 0)},e.prototype.visitNode=function(e,t){if(!this.visited.has(e)){this.visited.set(e,!0);var i=this.treeChanges.get(e),n=t;if((i&&i.childList||void 0==n)&&(n=this.treeChanges.reachabilityChange(e)),n!==r.MOVEMENT.STAYED_OUT){if(this.matchabilityChange(e),n===r.MOVEMENT.ENTERED)this.entered.push(e);else if(n===r.MOVEMENT.EXITED)this.exited.push(e),this.ensureHasOldPreviousSiblingIfNeeded(e);else if(n===r.MOVEMENT.STAYED_IN){var o=r.MOVEMENT.STAYED_IN;i&&i.childList&&(i.oldParentNode!==e.parentNode?(o=r.MOVEMENT.REPARENTED,this.ensureHasOldPreviousSiblingIfNeeded(e)):this.calcReordered&&this.wasReordered(e)&&(o=r.MOVEMENT.REORDERED)),this.stayedIn.set(e,o)}if(n!==r.MOVEMENT.STAYED_IN)for(var a=e.firstChild;a;a=a.nextSibling)this.visitNode(a,n)}}},e.prototype.ensureHasOldPreviousSiblingIfNeeded=function(e){if(this.calcOldPreviousSibling){this.processChildlistChanges();var t=this.treeChanges.get(e),r=e.parentNode;t&&t.oldParentNode&&(r=t.oldParentNode);var i=this.childListChangeMap.get(r);i||(i=new u,this.childListChangeMap.set(r,i)),i.oldPrevious.has(e)||i.oldPrevious.set(e,e.previousSibling)}},e.prototype.getChanged=function(e,t,i){this.selectors=t,this.characterDataOnly=i;for(var n=0;n<this.entered.length;n++){var o=this.entered[n];this.matchabilityChange(o)===r.MOVEMENT.STAYED_IN&&e.added.push(o)}var a=this.stayedIn.keys();for(n=0;n<a.length;n++){o=a[n];if(this.matchabilityChange(o)===r.MOVEMENT.STAYED_IN&&(e.reparented||e.reordered)){var s=this.stayedIn.get(o);e.reparented&&s===r.MOVEMENT.REPARENTED?e.reparented.push(o):e.reordered&&s===r.MOVEMENT.REORDERED&&e.reordered.push(o)}}for(n=0;n<this.exited.length;n++){o=this.exited[n];this.matchabilityChange(o)===r.MOVEMENT.STAYED_IN&&e.removed.push(o)}},e.prototype.getOldParentNode=function(e){var t=this.treeChanges.get(e);if(t&&t.childList)return t.oldParentNode?t.oldParentNode:null;var i=this.treeChanges.reachabilityChange(e);if(i===r.MOVEMENT.STAYED_OUT||i===r.MOVEMENT.ENTERED)throw Error("getOldParentNode requested on invalid node.");return e.parentNode},e.prototype.getOldPreviousSibling=function(e){var t=this.treeChanges.get(e),r=e.parentNode;t&&t.oldParentNode&&(r=t.oldParentNode);var i=this.childListChangeMap.get(r);if(!i)throw Error("getOldPreviousSibling requested on invalid node.");return i.oldPrevious.get(e)},e.prototype.getOldAttribute=function(e,t){var r=this.treeChanges.get(e);if(!r||!r.attributes)throw Error("getOldAttribute requested on invalid node.");var i=r.getAttributeOldValue(t);if(void 0===i)throw Error("getOldAttribute requested for unchanged attribute name.");return i},e.prototype.attributeChangedNodes=function(e){if(!this.treeChanges.anyAttributesChanged)return{};var t,i;if(e){t={},i={};for(var n=0;n<e.length;n++){t[l=e[n]]=!0,i[l.toLowerCase()]=l}}var o={},a=this.treeChanges.keys();for(n=0;n<a.length;n++){var s=a[n],u=this.treeChanges.get(s);if(u.attributes&&(r.MOVEMENT.STAYED_IN===this.treeChanges.reachabilityChange(s)&&r.MOVEMENT.STAYED_IN===this.matchabilityChange(s)))for(var c=s,h=u.getAttributeNamesMutated(),d=0;d<h.length;d++){var l=h[d];if(!t||t[l]||u.isCaseInsensitive&&i[l])u.getAttributeOldValue(l)!==c.getAttribute(l)&&(i&&u.isCaseInsensitive&&(l=i[l]),o[l]=o[l]||[],o[l].push(c))}}return o},e.prototype.getOldCharacterData=function(e){var t=this.treeChanges.get(e);if(!t||!t.characterData)throw Error("getOldCharacterData requested on invalid node.");return t.characterDataOldValue},e.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var e=this.treeChanges.keys(),t=[],i=0;i<e.length;i++){var n=e[i];if(r.MOVEMENT.STAYED_IN===this.treeChanges.reachabilityChange(n)){var o=this.treeChanges.get(n);o.characterData&&n.textContent!=o.characterDataOldValue&&t.push(n)}}return t},e.prototype.computeMatchabilityChange=function(e,t){this.matchCache||(this.matchCache=[]),this.matchCache[e.uid]||(this.matchCache[e.uid]=new a);var r=this.matchCache[e.uid],i=r.get(t);return void 0===i&&(i=e.matchabilityChange(t,this.treeChanges.get(t)),r.set(t,i)),i},e.prototype.matchabilityChange=function(e){var t=this;if(this.characterDataOnly)switch(e.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return r.MOVEMENT.STAYED_IN;default:return r.MOVEMENT.STAYED_OUT}if(!this.selectors)return r.MOVEMENT.STAYED_IN;if(e.nodeType!==Node.ELEMENT_NODE)return r.MOVEMENT.STAYED_OUT;for(var i=e,n=this.selectors.map(function(e){return t.computeMatchabilityChange(e,i)}),o=r.MOVEMENT.STAYED_OUT,a=0;o!==r.MOVEMENT.STAYED_IN&&a<n.length;){switch(n[a]){case r.MOVEMENT.STAYED_IN:o=r.MOVEMENT.STAYED_IN;break;case r.MOVEMENT.ENTERED:o=o===r.MOVEMENT.EXITED?r.MOVEMENT.STAYED_IN:r.MOVEMENT.ENTERED;break;case r.MOVEMENT.EXITED:o=o===r.MOVEMENT.ENTERED?r.MOVEMENT.STAYED_IN:r.MOVEMENT.EXITED}a++}return o},e.prototype.getChildlistChange=function(e){var t=this.childListChangeMap.get(e);return t||(t=new u,this.childListChangeMap.set(e,t)),t},e.prototype.processChildlistChanges=function(){if(!this.childListChangeMap){this.childListChangeMap=new a;for(var e=function(e){var i=t.mutations[e];if("childList"!=i.type)return"continue";if(t.treeChanges.reachabilityChange(i.target)!==r.MOVEMENT.STAYED_IN&&!t.calcOldPreviousSibling)return"continue";for(var n=t.getChildlistChange(i.target),o=i.previousSibling,a=function(e,t){!e||n.oldPrevious.has(e)||n.added.has(e)||n.maybeMoved.has(e)||t&&(n.added.has(t)||n.maybeMoved.has(t))||n.oldPrevious.set(e,t)},s=0;s<i.removedNodes.length;s++){a(u=i.removedNodes[s],o),n.added.has(u)?n.added.delete(u):(n.removed.set(u,!0),n.maybeMoved.delete(u)),o=u}a(i.nextSibling,o);for(s=0;s<i.addedNodes.length;s++){var u=i.addedNodes[s];n.removed.has(u)?(n.removed.delete(u),n.maybeMoved.set(u,!0)):n.added.set(u,!0)}},t=this,i=0;i<this.mutations.length;i++)e(i)}},e.prototype.wasReordered=function(e){if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var t=this.treeChanges.get(e),r=e.parentNode;t&&t.oldParentNode&&(r=t.oldParentNode);var i=this.childListChangeMap.get(r);if(!i)return!1;if(i.moved)return i.moved.get(e);i.moved=new a;var n=new a,o=function(e){if(!e)return!1;if(!i.maybeMoved.has(e))return!1;var t=i.moved.get(e);return void 0!==t?t:(n.has(e)?t=!0:(n.set(e,!0),t=h(e)!==u(e)),n.has(e)?(n.delete(e),i.moved.set(e,t)):t=i.moved.get(e),t)},s=new a,u=function(e){var t=s.get(e);if(void 0!==t)return t;for(t=i.oldPrevious.get(e);t&&(i.removed.has(t)||o(t));)t=u(t);return void 0===t&&(t=e.previousSibling),s.set(e,t),t},c=new a,h=function(e){if(c.has(e))return c.get(e);for(var t=e.previousSibling;t&&(i.added.has(t)||o(t));)t=t.previousSibling;return c.set(e,t),t};return i.maybeMoved.keys().forEach(o),i.moved.get(e)},e}(),d=function(){function e(e,t){var r=this;if(this.projection=e,this.added=[],this.removed=[],this.reparented=t.all||t.element||t.characterData?[]:void 0,this.reordered=t.all?[]:void 0,e.getChanged(this,t.elementFilter,t.characterData),t.all||t.attribute||t.attributeList){var i=t.attribute?[t.attribute]:t.attributeList,n=e.attributeChangedNodes(i);t.attribute?this.valueChanged=n[t.attribute]||[]:(this.attributeChanged=n,t.attributeList&&t.attributeList.forEach(function(e){r.attributeChanged.hasOwnProperty(e)||(r.attributeChanged[e]=[])}))}if(t.all||t.characterData){var o=e.getCharacterDataChanged();t.characterData?this.valueChanged=o:this.characterDataChanged=o}this.reordered&&(this.getOldPreviousSibling=e.getOldPreviousSibling.bind(e))}return e.prototype.getOldParentNode=function(e){return this.projection.getOldParentNode(e)},e.prototype.getOldAttribute=function(e,t){return this.projection.getOldAttribute(e,t)},e.prototype.getOldCharacterData=function(e){return this.projection.getOldCharacterData(e)},e.prototype.getOldPreviousSibling=function(e){return this.projection.getOldPreviousSibling(e)},e}();t.Summary=d;var l=/[a-zA-Z_]+/,f=/[a-zA-Z0-9_\-]+/;function g(e){return'"'+e.replace(/"/,'\\"')+'"'}var p=function(){function e(){}return e.prototype.matches=function(e){if(null===e)return!1;if(void 0===this.attrValue)return!0;if(!this.contains)return this.attrValue==e;for(var t=e.split(" "),r=0;r<t.length;r++)if(this.attrValue===t[r])return!0;return!1},e.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+g(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+g(this.attrValue)+"]":void 0:"#"+this.attrValue},e}(),v=function(){function e(){this.uid=e.nextUid++,this.qualifiers=[]}var t;return Object.defineProperty(e.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!1,configurable:!0}),e.prototype.isMatching=function(t){return t[e.matchesSelector](this.selectorString)},e.prototype.wasMatching=function(e,t,r){if(!t||!t.attributes)return r;var i=t.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==i&&i!==e.tagName)return!1;for(var n=[],o=!1,a=0;a<this.qualifiers.length;a++){var s=this.qualifiers[a],u=t.getAttributeOldValue(s.attrName);n.push(u),o=o||void 0!==u}if(!o)return r;for(a=0;a<this.qualifiers.length;a++){s=this.qualifiers[a];if(void 0===(u=n[a])&&(u=e.getAttribute(s.attrName)),!s.matches(u))return!1}return!0},e.prototype.matchabilityChange=function(e,t){var i=this.isMatching(e);return i?this.wasMatching(e,t,i)?r.MOVEMENT.STAYED_IN:r.MOVEMENT.ENTERED:this.wasMatching(e,t,i)?r.MOVEMENT.EXITED:r.MOVEMENT.STAYED_OUT},e.parseSelectors=function(t){var r,i,n=[];function o(){r&&(i&&(r.qualifiers.push(i),i=void 0),n.push(r)),r=new e}function a(){i&&r.qualifiers.push(i),i=new p}for(var s,u=/\s/,c="Invalid or unsupported selector syntax.",h=1,d=0;d<t.length;){var g=t[d++];switch(h){case 1:if(g.match(l)){o(),r.tagName=g,h=2;break}if("*"==g){o(),r.tagName="*",h=3;break}if("."==g){o(),a(),r.tagName="*",i.attrName="class",i.contains=!0,h=4;break}if("#"==g){o(),a(),r.tagName="*",i.attrName="id",h=4;break}if("["==g){o(),a(),r.tagName="*",i.attrName="",h=6;break}if(g.match(u))break;throw Error(c);case 2:if(g.match(f)){r.tagName+=g;break}if("."==g){a(),i.attrName="class",i.contains=!0,h=4;break}if("#"==g){a(),i.attrName="id",h=4;break}if("["==g){a(),i.attrName="",h=6;break}if(g.match(u)){h=14;break}if(","==g){h=1;break}throw Error(c);case 3:if("."==g){a(),i.attrName="class",i.contains=!0,h=4;break}if("#"==g){a(),i.attrName="id",h=4;break}if("["==g){a(),i.attrName="",h=6;break}if(g.match(u)){h=14;break}if(","==g){h=1;break}throw Error(c);case 4:if(g.match(l)){i.attrValue=g,h=5;break}throw Error(c);case 5:if(g.match(f)){i.attrValue+=g;break}if("."==g){a(),i.attrName="class",i.contains=!0,h=4;break}if("#"==g){a(),i.attrName="id",h=4;break}if("["==g){a(),h=6;break}if(g.match(u)){h=14;break}if(","==g){h=1;break}throw Error(c);case 6:if(g.match(l)){i.attrName=g,h=7;break}if(g.match(u))break;throw Error(c);case 7:if(g.match(f)){i.attrName+=g;break}if(g.match(u)){h=8;break}if("~"==g){i.contains=!0,h=9;break}if("="==g){i.attrValue="",h=11;break}if("]"==g){h=3;break}throw Error(c);case 8:if("~"==g){i.contains=!0,h=9;break}if("="==g){i.attrValue="",h=11;break}if("]"==g){h=3;break}if(g.match(u))break;throw Error(c);case 9:if("="==g){i.attrValue="",h=11;break}throw Error(c);case 10:if("]"==g){h=3;break}if(g.match(u))break;throw Error(c);case 11:if(g.match(u))break;if('"'==g||"'"==g){s=g,h=13;break}i.attrValue+=g,h=12;break;case 12:if(g.match(u)){h=10;break}if("]"==g){h=3;break}if("'"==g||'"'==g)throw Error(c);i.attrValue+=g;break;case 13:if(g==s){h=10;break}i.attrValue+=g;break;case 14:if(g.match(u))break;if(","==g){h=1;break}throw Error(c)}}switch(h){case 1:case 2:case 3:case 5:case 14:o();break;default:throw Error(c)}if(!n.length)throw Error(c);return n},e.nextUid=1,e.matchesSelector="function"==typeof(t=document.createElement("div")).webkitMatchesSelector?"webkitMatchesSelector":"function"==typeof t.mozMatchesSelector?"mozMatchesSelector":"function"==typeof t.msMatchesSelector?"msMatchesSelector":"matchesSelector",e}(),E=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function b(e){if("string"!=typeof e)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!(e=e.trim()))throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!e.match(E))throw Error("Invalid request option. invalid attribute name: "+e);return e}function m(e){if(!e.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var t={},r={},i=e.split(/\s+/),n=0;n<i.length;n++){if(o=i[n]){var o,a=(o=b(o)).toLowerCase();if(t[a])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");r[o]=!0,t[a]=!0}}return Object.keys(r)}var O=function(){function e(t){var r=this;this.connected=!1,this.options=e.validateOptions(t),this.observerOptions=e.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map(function(e){return e.elementFilter?e.elementFilter:[]})),this.elementFilter.length||(this.elementFilter=void 0),this.calcReordered=this.options.queries.some(function(e){return e.all}),this.queryValidators=[],e.createQueryValidator&&(this.queryValidators=this.options.queries.map(function(t){return e.createQueryValidator(r.root,t)})),this.observer=new o(function(e){r.observerCallback(e)}),this.reconnect()}return e.createObserverOptions=function(e){var t,r={childList:!0,subtree:!0};function i(e){r.attributes&&!t||(r.attributes=!0,r.attributeOldValue=!0,e?(t=t||{},e.forEach(function(e){t[e]=!0,t[e.toLowerCase()]=!0})):t=void 0)}return e.forEach(function(e){if(e.characterData)return r.characterData=!0,void(r.characterDataOldValue=!0);if(e.all)return i(),r.characterData=!0,void(r.characterDataOldValue=!0);if(e.attribute)i([e.attribute.trim()]);else{var t=function(e){var t={};return e.forEach(function(e){e.qualifiers.forEach(function(e){t[e.attrName]=!0})}),Object.keys(t)}(e.elementFilter).concat(e.attributeList||[]);t.length&&i(t)}}),t&&(r.attributeFilter=Object.keys(t)),r},e.validateOptions=function(t){for(var r in t)if(!(r in e.optionKeys))throw Error("Invalid option: "+r);if("function"!=typeof t.callback)throw Error("Invalid options: callback is required and must be a function");if(!t.queries||!t.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var i={callback:t.callback,rootNode:t.rootNode||document,observeOwnChanges:!!t.observeOwnChanges,oldPreviousSibling:!!t.oldPreviousSibling,queries:[]},n=0;n<t.queries.length;n++){var o=t.queries[n];if(o.all){if(Object.keys(o).length>1)throw Error("Invalid request option. all has no options.");i.queries.push({all:!0})}else if("attribute"in o){if((s={attribute:b(o.attribute)}).elementFilter=v.parseSelectors("*["+s.attribute+"]"),Object.keys(o).length>1)throw Error("Invalid request option. attribute has no options.");i.queries.push(s)}else if("element"in o){var a=Object.keys(o).length,s={element:o.element,elementFilter:v.parseSelectors(o.element)};if(o.hasOwnProperty("elementAttributes")&&(s.attributeList=m(o.elementAttributes),a--),a>1)throw Error("Invalid request option. element only allows elementAttributes option.");i.queries.push(s)}else{if(!o.characterData)throw Error("Invalid request option. Unknown query request.");if(Object.keys(o).length>1)throw Error("Invalid request option. characterData has no options.");i.queries.push({characterData:!0})}}return i},e.prototype.createSummaries=function(e){if(!e||!e.length)return[];for(var t=new h(this.root,e,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),r=[],i=0;i<this.options.queries.length;i++)r.push(new d(t,this.options.queries[i]));return r},e.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach(function(e){e&&e.recordPreviousState()})},e.prototype.runQueryValidators=function(e){this.queryValidators.forEach(function(t,r){t&&t.validate(e[r])})},e.prototype.changesToReport=function(e){return e.some(function(e){if(["added","removed","reordered","reparented","valueChanged","characterDataChanged"].some(function(t){return e[t]&&e[t].length}))return!0;if(e.attributeChanged&&Object.keys(e.attributeChanged).some(function(t){return!!e.attributeChanged[t].length}))return!0;return!1})},e.prototype.isConnected=function(){return this.connected},e.prototype.observerCallback=function(e){this.options.observeOwnChanges||this.observer.disconnect();var t=this.createSummaries(e);this.runQueryValidators(t),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(t)&&this.callback(t),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},e.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},e.prototype.takeSummaries=function(){if(!this.connected)throw Error("Not connected");var e=this.createSummaries(this.observer.takeRecords());return this.changesToReport(e)?e:void 0},e.prototype.disconnect=function(){var e=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,e},e.NodeMap=a,e.parseElementFilter=v.parseSelectors,e.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},e}();t.MutationSummary=O})},{"../util/constants":7,"../util/types":8}],3:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../lib/mutationSummary"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TreeMirrorClient=void 0;var r=e("../lib/mutationSummary"),i=function(){function e(e,t){var i=this;this.target=e,this.mirror=t,this.nextId=1,this.knownNodes=new r.MutationSummary.NodeMap;for(var n=this.serializeNode(e).id,o=[],a=e.firstChild;a;a=a.nextSibling)o.push(this.serializeNode(a,!0));this.mirror.initialize(n,o);this.mutationSummary=new r.MutationSummary({rootNode:e,callback:function(e){i.applyChanged(e)},queries:[{all:!0}]})}return e.prototype.disconnect=function(){this.mutationSummary&&(this.mutationSummary.disconnect(),this.mutationSummary=void 0)},e.prototype.rememberNode=function(e){var t=this.nextId++;return this.knownNodes.set(e,t),t},e.prototype.forgetNode=function(e){this.knownNodes.delete(e)},e.prototype.serializeNode=function(e,t){if(null===e)return null;var r=this.knownNodes.get(e);if(void 0!==r)return{id:r};var i={nodeType:e.nodeType,id:this.rememberNode(e)};switch(i.nodeType){case Node.DOCUMENT_TYPE_NODE:var n=e;i.name=n.name,i.publicId=n.publicId,i.systemId=n.systemId;break;case Node.COMMENT_NODE:case Node.TEXT_NODE:i.textContent=e.textContent;break;case Node.ELEMENT_NODE:var o=e;i.tagName=o.tagName,i.attributes={};for(var a=0;a<o.attributes.length;a++){var s=o.attributes[a];i.attributes[s.name]=s.value}if(t&&o.childNodes.length){i.childNodes=[];for(var u=o.firstChild;u;u=u.nextSibling)i.childNodes.push(this.serializeNode(u,!0))}}return i},e.prototype.serializeAddedAndMoved=function(e,t,i){var n=this,o=e.concat(t).concat(i),a=new r.MutationSummary.NodeMap;o.forEach(function(e){var t=e.parentNode,i=a.get(t);i||(i=new r.MutationSummary.NodeMap,a.set(t,i)),i.set(e,!0)});var s=[];return a.keys().forEach(function(e){for(var t=a.get(e),r=t.keys();r.length;){for(var i=r[0];i.previousSibling&&t.has(i.previousSibling);)i=i.previousSibling;for(;i&&t.has(i);){var o=n.serializeNode(i);o.previousSibling=n.serializeNode(i.previousSibling),o.parentNode=n.serializeNode(i.parentNode),s.push(o),t.delete(i),i=i.nextSibling}r=t.keys()}}),s},e.prototype.serializeAttributeChanges=function(e){var t=this,i=new r.MutationSummary.NodeMap;return Object.keys(e).forEach(function(r){e[r].forEach(function(e){var n=i.get(e);n||((n=t.serializeNode(e)).attributes={},i.set(e,n)),n.attributes[r]=e.getAttribute(r)})}),i.keys().map(function(e){return i.get(e)})},e.prototype.applyChanged=function(e){var t=this,r=e[0],i=r.removed.map(function(e){return t.serializeNode(e)}),n=this.serializeAddedAndMoved(r.added,r.reparented,r.reordered),o=this.serializeAttributeChanges(r.attributeChanged),a=r.characterDataChanged.map(function(e){var r=t.serializeNode(e);return r.textContent=e.textContent,r});this.mirror.applyChanged(i,n,o,a),r.removed.forEach(function(e){t.forgetNode(e)})},e}();t.TreeMirrorClient=i})},{"../lib/mutationSummary":2}],4:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../lib/treeMirror","../util/util"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOMObserver=void 0;var r=e("../lib/treeMirror"),i=e("../util/util"),n=function(){function e(e,t){i.Logger.log("initializing dom observer"),this.treeMirrorClient=null,this._targetNode=e,this._callbacks=t}return e.prototype.createTreeMirror=function(){var e=this;return new r.TreeMirrorClient(this._targetNode,{initialize:function(t,r){var i={rootId:t,children:r};e._callbacks.init(i)},applyChanged:function(t,r,i,n){if(t.length||r.length||i.length||n.length){var o={removed:t,changed:r,attrs:i,text:n};e._callbacks.changed(o)}}})},e.prototype.connect=function(){null===this.treeMirrorClient?(i.Logger.log("connecting dom mirror"),this.treeMirrorClient=this.createTreeMirror()):i.Logger.log("dom mirror already connected")},e.prototype.disconnect=function(){null!==this.treeMirrorClient?(i.Logger.log("disconnecting dom mirror"),this.treeMirrorClient.disconnect(),this.treeMirrorClient=null):i.Logger.log("dom mirror already disconnected")},e.createFromTargetObject=function(t,r){return new e(document,{init:function(e){i.Logger.log("handling initial dom"),i.Logger.log(e),t.push({timestamp:(new Date).getTime(),dom:e,title:document.title,host:document.location.host,pathname:document.location.pathname,search:document.location.search,userAgent:navigator.userAgent})},changed:function(e){i.Logger.log("handling "+(e.attrs.length+e.removed.length+e.changed.length+e.text.length)+" dom mutations"),i.Logger.log(e),r.push({timestamp:(new Date).getTime(),dom:e})}})},e}();t.DOMObserver=n})},{"../lib/treeMirror":3,"../util/util":9}],5:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../util/types","../util/constants","../util/util"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventObserver=void 0;var r=e("../util/types"),i=e("../util/constants"),n=e("../util/util"),o=function(){function e(e){n.Logger.log("initializing event observer"),this.eventConfig=n.createListeners(this),this._container=e,this._lastMouseState={x:0,y:0}}return e.prototype.handleEvent=function(e){var t=!0;if(e instanceof Event){var o=n.tryGetNumber(e.type),a=this._container.length>0?this._container[this._container.length-1]:null,s=n.getWindowsSize(),u=s[0],c=s[1],h={timestamp:(new Date).getUTCMilliseconds(),target:n.getElementPath(e.target),event:"string"==typeof o?n.getMouseEventType(o):o,width:u,height:c,xd:n.getScrollLeft(),yd:n.getScrollTop()};switch(e instanceof MouseEvent&&(h.x=e.clientX+h.xd,h.y=e.clientY+h.yd,h.clickType=e.button),h.event){case r.EVENT.MOUSE_MOVE:a&&a.event===r.EVENT.MOUSE_MOVE&&(t=this.handleMousemove(a,h));break;case r.EVENT.MOUSE_DOWN:a&&a.event===r.EVENT.MOUSE_DOWN&&h.timestamp-a.timestamp<i.MOUSE_MOVE_INTERVAL&&(t=!1);break;case r.EVENT.MOUSE_SCROLL:a&&a.event===r.EVENT.MOUSE_SCROLL&&(t=this.handleMouseScroll(a,h));break;case r.EVENT.WINDOW_RESIZE:a&&a.event===r.EVENT.WINDOW_RESIZE&&(t=!1,this._container[this._container.length-1]=h)}return t&&(n.Logger.log("handled event"),n.Logger.log(h),this._container.push(h)),t}return n.Logger.log("unable to handle event, invalid type"),!1},e.prototype.start=function(){n.Logger.log("adding event observer listeners"),n.addEventListeners(this.eventConfig)},e.prototype.stop=function(){n.Logger.log("removing event observer listeners"),n.removeEventListeners(this.eventConfig)},e.prototype.handleMousemove=function(e,t){var r=e.x-t.x,n=e.y-t.y,o={x:-1,y:n>=0?1:-1},a=!0;return Math.abs(r)<i.MOUSE_MOVE_DIFF&&Math.abs(n)<i.MOUSE_MOVE_DIFF?a=!1:o.x!==this._lastMouseState.x||o.y!==this._lastMouseState.y?this._lastMouseState=o:(a=!1,this._container[this._container.length-1]=t),a},e.prototype.handleMouseScroll=function(e,t){var i=!0;return e.yd>t.yd?t.scrollDirection=r.EVENT.MOUSE_SCROLL_UP:e.yd<t.yd?t.scrollDirection=r.EVENT.MOUSE_SCROLL_DOWN:e.xd>t.xd?t.scrollDirection=r.EVENT.MOUSE_SCROLL_LEFT:e.xd<t.xd&&(t.scrollDirection=r.EVENT.MOUSE_SCROLL_RIGHT),void 0!==e.scrollDirection&&e.scrollDirection===t.scrollDirection&&(i=!1,this._container[this._container.length-1]=t),i},e}();t.EventObserver=o})},{"../util/constants":7,"../util/types":8,"../util/util":9}],6:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../modules/domObserver","../modules/eventObserver"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Observer=void 0;var r=e("../modules/domObserver"),i=e("../modules/eventObserver"),n=function(){function e(){this.initialDom=[],this.changedDom=[],this.clientEvents=[],this._domObserver=r.DOMObserver.createFromTargetObject(this.initialDom,this.changedDom),this._eventObserver=new i.EventObserver(this.clientEvents)}return e.prototype.start=function(){this._domObserver.connect(),this._eventObserver.start()},e.prototype.stop=function(){this._domObserver.disconnect(),this._eventObserver.stop()},e}();t.Observer=n})},{"../modules/domObserver":4,"../modules/eventObserver":5}],7:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorMessage=t.MOUSE_MOVE_DIFF=t.MOUSE_MOVE_INTERVAL=t.B64_CHARACTERS=t.MUTATION_SUMMARY_ID_PROP=t.OFFLOAD_EVENT=t.NAMED_EVENTS=void 0,t.NAMED_EVENTS=["mousemove","mousedown","scroll","resize"],t.OFFLOAD_EVENT="unload",t.MUTATION_SUMMARY_ID_PROP="__webalyze_node_map_id__",t.B64_CHARACTERS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t.MOUSE_MOVE_INTERVAL=1e3,t.MOUSE_MOVE_DIFF=10,t.errorMessage={storage:"Session Storage is a required for Webalyze\nhttps://developer.mozilla.org/en-US/docs/Web/API/Storage",observer:"Mutation Observers are a required for Webalyze\nhttps://developer.mozilla.org/en-US/docs/Web/API/MutationObserver"}})},{}],8:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT=t.MOVEMENT=void 0,function(e){e[e.STAYED_OUT=0]="STAYED_OUT",e[e.ENTERED=1]="ENTERED",e[e.STAYED_IN=2]="STAYED_IN",e[e.REPARENTED=3]="REPARENTED",e[e.REORDERED=4]="REORDERED",e[e.EXITED=5]="EXITED"}(t.MOVEMENT||(t.MOVEMENT={})),function(e){e[e.MOUSE_CLICK_PRIMARY=0]="MOUSE_CLICK_PRIMARY",e[e.MOUSE_CLICK_MIDDLE=1]="MOUSE_CLICK_MIDDLE",e[e.MOUSE_CLICK_RIGHT=2]="MOUSE_CLICK_RIGHT",e[e.MOUSE_CLICK_BACK=3]="MOUSE_CLICK_BACK",e[e.MOUSE_CLICK_FORWARD=4]="MOUSE_CLICK_FORWARD",e[e.MOUSE_SCROLL_UP=5]="MOUSE_SCROLL_UP",e[e.MOUSE_SCROLL_DOWN=6]="MOUSE_SCROLL_DOWN",e[e.MOUSE_SCROLL_LEFT=7]="MOUSE_SCROLL_LEFT",e[e.MOUSE_SCROLL_RIGHT=8]="MOUSE_SCROLL_RIGHT",e[e.START=9]="START",e[e.STOP=10]="STOP",e[e.MOUSE_MOVE=11]="MOUSE_MOVE",e[e.MOUSE_DOWN=12]="MOUSE_DOWN",e[e.MOUSE_SCROLL=13]="MOUSE_SCROLL",e[e.WINDOW_RESIZE=14]="WINDOW_RESIZE",e[e.WINDOW_UNLOAD=15]="WINDOW_UNLOAD"}(t.EVENT||(t.EVENT={}))})},{}],9:[function(e,t,r){!function(i){if("object"==typeof t&&"object"==typeof t.exports){var n=i(e,r);void 0!==n&&(t.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../util/constants","../util/types"],i)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.b64EncodeObject=t.createListeners=t.tryGetNumber=t.getScrollTop=t.getScrollLeft=t.getWindowsSize=t.removeEventListeners=t.addEventListeners=t.getAttrs=t.stringifyElementSelector=t.getElementPath=t.getMouseEventType=void 0;var r=e("../util/constants"),i=e("../util/types");t.getMouseEventType=function(e){var t=r.NAMED_EVENTS.indexOf(e.toLowerCase());return t>-1?t+i.EVENT.MOUSE_MOVE:t},t.getElementPath=function(e){if(e&&e instanceof HTMLElement){for(var r=[],i=e.parentElement;i&&"html"!==i.tagName.toLowerCase();)r.push(t.stringifyElementSelector(i)),i=i.parentElement;var n=r.reverse().join(" > ")+" > "+t.stringifyElementSelector(e);return n.match(/>/g).length>1?n:n.replace(/>/,"").trim()}return""},t.stringifyElementSelector=function(e){if(e){var t=e.tagName.toLowerCase(),r=e.id,i=e.classList.toString().replace(/\s/g,".");return r?t+"#"+r:i?t+"."+i:t}return""};var n=function(e,t,r,i,n){return e+(t+"=")+r+(n<i?"|":"")};t.getAttrs=function(e){for(var t=e.getAttributeNames(),r="",i=0;i<t.length;i++)r=n(r,t[i],e.getAttribute(t[i]),t.length-1,i);return r},t.addEventListeners=function(e){if(e&&e.length>0){for(var t=0;t<e.length;t++){var r=e[t];try{r.origin.addEventListener(r.listener,r.handler)}catch(e){console.error(e)}}return!0}return!1},t.removeEventListeners=function(e){if(e&&e.length>0){for(var t=0;t<e.length;t++){var r=e[t];try{r.origin.removeEventListener(r.listener,r.handler)}catch(e){console.error(e)}}return!0}return!1},t.getWindowsSize=function(){return void 0!==window.innerWidth?[window.innerWidth,window.innerHeight]:void 0!==window.document.documentElement&&void 0!==window.document.documentElement.clientWidth?[window.document.documentElement.clientWidth,window.document.documentElement.clientHeight]:[0,0]},t.getScrollLeft=function(){return window.pageXOffset?window.pageXOffset:window.document.documentElement?window.document.documentElement.scrollLeft:window.document.body?window.document.body.scrollLeft:0},t.getScrollTop=function(){return window.pageYOffset?window.pageYOffset:window.document.documentElement?window.document.documentElement.scrollTop:window.document.body?window.document.body.scrollTop:0},t.tryGetNumber=function(e){var t=parseInt(e);return void 0===t||"number"!=typeof t||isNaN(t)?e:t},t.createListeners=function(e){for(var t=e.handleEvent.bind(e),i=[],n=[[window.document,r.NAMED_EVENTS[0]],[window.document,r.NAMED_EVENTS[1]],[window,r.NAMED_EVENTS[2]],[window,r.NAMED_EVENTS[3]],[window,r.NAMED_EVENTS[4]]],o=0;o<n.length;o++){var a=n[o];i.push({origin:a[0],listener:a[1],handler:t})}return i},t.b64EncodeObject=function(e){return btoa(JSON.stringify(e))};var o=function(){function e(){}return e.toggle=function(t){e.state=t},e.log=function(t){e.toggle(window.webalyzeDebug||0),e.state&&("string"==typeof t?console.log("webalyze debug "+(new Date).getTime()+" || "+t):"object"==typeof t&&console.log(t))},e.state=0,e}();t.Logger=o})},{"../util/constants":7,"../util/types":8}]},{},[1]);